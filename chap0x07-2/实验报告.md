# Exp-07.2 åŸºäºJuice Shopçš„æ¼æ´åˆ©ç”¨

### 1. å®éªŒç›®çš„

- [x] äº†è§£å¸¸è§ Web æ¼æ´è®­ç»ƒå¹³å°

- [x] äº†è§£å¸¸è§ Web æ¼æ´çš„åŸºæœ¬åŸç†ï¼›

- [x] æŒæ¡ OWASP Top 10 åŠå¸¸è§ Web é«˜å±æ¼æ´çš„æ¼æ´æ£€æµ‹ã€æ¼æ´åˆ©ç”¨å’Œæ¼æ´ä¿®å¤æ–¹æ³•

### 2. å®éªŒè¦æ±‚

- [x] å®Œæˆä¸å°‘äº 5 ç§ä¸åŒæ¼æ´ç±»å‹çš„æ¼æ´åˆ©ç”¨ç»ƒä¹ 

- [x] ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ä¸åŒäºå®˜æ–¹æ•™ç¨‹ä¸­çš„æ¼æ´åˆ©ç”¨æ–¹æ³•å®Œæˆç›®æ ‡æ¼æ´åˆ©ç”¨ç»ƒä¹ 

  *ï¼ˆæ³¨ï¼šå‚è€ƒSolutionçš„é¢˜è§£å·²åœ¨å®éªŒæŠ¥å‘Šä¸­æ³¨æ˜ï¼‰

- [x] ï¼ˆå¯é€‰ï¼‰å®šä½ç¼ºé™·ä»£ç 

- [x] ï¼ˆå¯é€‰ï¼‰å°è¯•ä»æºä»£ç å±‚é¢ä¿®å¤æ¼æ´

### 3. å®éªŒç¯å¢ƒ

- docker.io 19.03.13+dfsg1-2

- Juice Shop

### 4. å®éªŒå®Œæˆåº¦

### 5. å®éªŒå‡†å¤‡

- Juice Shopæ¼æ´æ”»é˜²è®­ç»ƒç¯å¢ƒæ­å»º

    ```cmd
    # åœ¨ /etc/apt/sources.list ä¸­æ·»åŠ  Docker å®˜æ–¹çš„ apt é•œåƒæºåœ°å€
    if [[ $(grep -c "docker.com" /etc/apt/sources.list) -eq 0 ]];then echo "deb https://download.docker.com/linux/debian buster stable" >> /etc/apt/sources.list;fi
    # æ·»åŠ  Docker å®˜æ–¹çš„ GPG å…¬é’¥åˆ°ç³»ç»Ÿå—ä¿¡ä»»å…¬é’¥æ•°æ®åº“
    curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -
    apt-get update
    # å®‰è£…docker-ce
    apt-get install docker-ce
    # æ³¨ï¼šå®¹å™¨éƒ¨åˆ†ä½¿ç”¨Exp-7.1ä¸­ä¸‹è½½å¥½çš„ctf-games
    # åˆ‡æ¢å·¥ä½œç›®å½•
    cd /home/idchannov/workspace/ctf-games/owasp/juice-shop
    # å¯åŠ¨ webgoat ç³»åˆ—æœåŠ¡
    docker-compose up -d
    # æŸ¥çœ‹å½“å‰å®¹å™¨çŠ¶æ€
    docker ps
    ```

    ![img](img/prep-before.PNG)

    ![img](img/prep-after.PNG)

    ![img](img/compose-finish.PNG)

    ![img](img/docker-status.PNG)

    ![img](img/juice-shop-start.PNG)

### 6. æ¼æ´åˆ©ç”¨

- **Finding the Score Board**(â­)

    - æ–¹æ³•ä¸€ï¼šåœ¨ç½‘é¡µå†…ç‚¹å‡»å„ç§æŒ‰é’®è§‚å¯ŸURLï¼Œå‘ç°ç½‘é¡µçš„è®¿é—®é“¾æ¥æ˜¯ä»¥`127.0.0.1:3000/#/content`çš„å½¢å¼ç»„ç»‡çš„ï¼Œåœ¨å°è¯• score å’Œ board çš„å„ç§ç»„åˆåï¼Œå‘ç°è¾“å…¥`127.0.0.1:3000/#/score-board`å¯ä»¥æˆåŠŸè®¿é—®è®¡åˆ†æ¿
    
    - æ–¹æ³•äºŒï¼šåœ¨FireFox - Inspect Elementä¸­æœç´¢å…³é”®è¯

        ![img](img/score-board-search.PNG)

    ![img](img/score-board.PNG)

- **Injection**

    - Christmas Special(â­â­â­)

        1. åœ¨Burp Suiteä¸­è§‚å¯Ÿè¯·æ±‚ç‰¹å¾ï¼Œå‘ç°å¯èƒ½å¯ä»¥é€šè¿‡`http://127.0.0.1:3000/rest/products/search?q=xxx`æŸ¥æ‰¾åˆ°å•†å“ä¿¡æ¯ï¼Œè¿›è¡Œå°è¯•åå‘ç°ç¡®å®å¦‚æ­¤

            ![img](img/christmas-deleted-request.PNG)

            ![img](img/christmas-deleted-try.PNG)

        2. è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»å¾—åˆ°è¢«åˆ é™¤çš„å•†å“ä¿¡æ¯

            ![img](img/christmas-deleted-info.PNG)

        3. å°è¯•è´­ä¹°å•†å“ï¼Œåœ¨Burp Suiteä¸­è§‚å¯Ÿè¯·æ±‚ç‰¹å¾ï¼Œæ‰¾åˆ°å¯èƒ½ä¸å°†å•†å“åŠ å…¥è´­ç‰©è½¦çš„è¯·æ±‚åå‘é€è‡³Repeaterï¼Œä¿®æ”¹å‚æ•°åå‘é€ï¼Œè¿™æ ·å¯å°†è¢«åˆ é™¤çš„å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œç»“è´¦åå³å¯å®Œæˆå®éªŒ

            ![img](img/christmas-deleted-edit.PNG)

            ![img](img/christmas-deleted-basket.PNG)

        ![img](img/christmas-deleted.PNG)

    - Login Admin(â­â­)

        è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ï¼Œè¾“å…¥è¯­å¥ä¸º`admin@juice-sh.op'--`

        ![img](img/login-admin.PNG)

    - Login Bender(â­â­â­)ï¼ˆå‚è€ƒSolutionï¼‰
    
        è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ï¼Œè¾“å…¥è¯­å¥ä¸º`bender@juice-sh.op'--`

        ![img](img/login-bender.PNG)

        **ç–‘é—®ï¼š** ä¸çŸ¥é“è¿™ä¸ªé‚®ç®±åç§°æ˜¯å’‹çŒœåˆ°çš„ï¼Œæ˜¯Juice Shopçš„å†…ç½®ç”¨æˆ·éƒ½æœ‰é»˜è®¤åç¼€å—ï¼Ÿ

    - Login Jim(â­â­â­)

        1. çŒœæµ‹Jimçš„é‚®ç®±ï¼Œç›²çŒœå‰ç¼€æ˜¯jim

        2. è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ï¼Œå‘ç°ä½¿ç”¨é‚®ç®±jim@juice-sh.opå¯ä»¥æˆåŠŸç™»å½•ï¼Œè¾“å…¥è¯­å¥ä¸º`jim@juice-sh.op'--`

        ![img](img/login-jim.PNG)

    - User Credentials(â­â­â­â­)

        ä¹‹å‰åœ¨Christmas Specialé¢˜ç›®ä¸­é€šè¿‡`http://127.0.0.1:3000/rest/products/search?q=xxx`æŸ¥æ‰¾åˆ°äº†å•†å“ä¿¡æ¯ï¼Œå› æ­¤ç›®å‰åœ¨ä¸çŸ¥é“userçš„æŸ¥è¯¢è·¯å¾„&æ˜¯å¦æœ‰å‡†ç¡®çš„æŸ¥è¯¢è·¯å¾„çš„æ¡ä»¶ä¸‹å¯ä»¥é€šè¿‡UNION SQLæ”»å‡»çš„æ–¹å¼å¾—åˆ°ç›®æ ‡æ•°æ®åº“ï¼Œæ³¨å…¥è¯­å¥å¦‚ä¸‹ï¼š

        ```
        http://127.0.0.1:3000/rest/products/search?q=qwert')) UNION SELECT id, email, password, lastLoginIp, profileImage, '6', '7', '8', '9' FROM Users--
        ```

        æ³¨ï¼šç”±äºåœ¨Log in with Chris' erased user accountä¸Christmas Specialä¸­å·²ç»çŸ¥é“äº†ç”¨æˆ·ä¸å•†å“çš„æ•°æ®åº“å­˜å‚¨ç»“æ„ï¼Œæ‰€ä»¥è¿™é‡Œä¸éœ€è¦ç»è¿‡å¤ªå¤šæ¬¡çš„æ³¨å…¥å°è¯•ï¼Œä½†å®é™…æƒ…å†µä¸­éœ€è¦æ ¹æ®ç½‘é¡µå“åº”æ¥é€æ­¥è°ƒæ•´æ³¨å…¥è¯­å¥

        ![img](img/user-credentials-attack.PNG)

        ![img](img/user-credentials.PNG)

    - Database Schema(â­â­â­)

        æ³¨å…¥åŸç†åŒUser Credentialsï¼Œä½†ç•¥æœ‰ä¸åŒçš„æ˜¯æ­¤æ¬¡æ³¨å…¥æ”»å‡»ä¸­è¿æ¥çš„è¡¨ä¸ºsqlite_masterï¼Œæ³¨å…¥è¯­å¥å¦‚ä¸‹ï¼š

        ```
        http://127.0.0.1:3000/rest/products/search?q=qwert')) UNION SELECT sql, type, name, tbl_name, rootpage, '6', '7', '8', '9' FROM sqlite_master--
        ```

        ![img](img/entire-db-info.PNG)

        ![img](img/entire-db.PNG)

- **Broken Authentication**

    - Bjoern's Favorite Pet(â­â­â­)

        1. æ ¹æ®é¢˜ç›®çš„Hintåœ¨googleä¸Šæœç´¢å…³é”®è¯åå‡ºç°ä¸‹å›¾æ‰€ç¤ºçš„ä¿¡æ¯

            ![img](img/forget-password-media.PNG)

        2. ä¸€å¼€å§‹è¯¯ä»¥ä¸ºBjoernçš„ä¸ªäººä¿¡æ¯ä¼šæš´éœ²åœ¨Twitterä¹‹ç±»çš„ç¤¾äº¤å¹³å°æ¯”è¾ƒå¤šè€Œå¿½ç•¥äº†é¢˜ç›®ç»™å‡ºçš„æŒ‡å‘è§†é¢‘çš„ä¿¡æ¯æç¤ºæ‰€ä»¥æµªè´¹äº†å¾ˆå¤šåŠ›æ°”qwqâ€¦â€¦æœ€åæ ¹æ®Solutionåœ¨ä¸Šå›¾åœˆå‡ºçš„è§†é¢‘ä¸­æ‰¾åˆ°äº†BjoernæŸæ¬¡åœ¨æ¼”ç¤ºå¹³å°æ­å»ºçš„æ—¶å€™åˆ›å»ºçš„è´¦æˆ·ï¼Œä¹‹åè¾“å…¥å¯†ä¿é—®é¢˜ç­”æ¡ˆå³å¯å®Œæˆå®éªŒ

            ![img](img/forget-password-answer.PNG)

            ![img](img/forget-password.PNG)

            **ã€ï¼Ÿã€‘** è™½ç„¶å¯¹äºè¿™ä¸ªç®€æ˜“å¹³å°æ¥è¯´ç”¨æˆ·è´¦æˆ·çš„å¯†ä¿é—®é¢˜æŒ‡å‘æ€§ç›¸å¯¹è¾ƒä¸ºæ˜ç¡®ï¼Œä½†åœ¨å®é™…æƒ…å†µä¸­ä¼°è®¡è¿˜æ˜¯å¾—ç”¨pythonçˆ¬ä¸€ä¸‹çš„ï¼Œä½†ç›®å‰æ²¡æœ‰æƒ³å‡ºæ€ä¹ˆæå–è§†é¢‘çš„å…·ä½“å†…å®¹â€¦â€¦æ‰€ä»¥æœ€ç»ˆè¿˜æ˜¯å¾—ä¸€ä¸ªä¸€ä¸ªç›²çœ‹å—ï¼Ÿï¼Ÿï¼Ÿè¿™ç§æ•™å­¦è§†é¢‘æˆ‘è‚¯å®šç¬¬ä¸€ä¸ªè·³è¿‡å•Šqwq

    - Change Bender's Password(â­â­â­â­)

        1. ä½¿ç”¨SQLæ³¨å…¥çš„æ–¹å¼ç™»å…¥Benderçš„å¸å·

        2. åœ¨Burp Suiteä¸­æŸ¥çœ‹tokenå¹¶è§£ç å¦‚ä¸‹ï¼Œå¾—åˆ°ç”¨æˆ·å¯†ç çš„MD5ç¼–ç ç»“æœ

            ![img](img/reset-passwd-decode.PNG)

        3. æš´åŠ›ç ´è§£MD5å¾—åˆ°ç”¨æˆ·å¯†ç ï¼Œå¹¶ä¿®æ”¹ï¼ˆç›®å‰æœªè§£å¯†æˆåŠŸï¼‰

    - Log in with Chris' erased user account(â­â­â­)

        1. åœ¨ç™»å½•ç•Œé¢è¾“å…¥`\' or deletedAt IS NOT NULL--`ç™»å½•ååœ¨Burp Suiteä¸­æŸ¥çœ‹è¢«è½¯åˆ é™¤çš„è´¦æˆ·ä¿¡æ¯

            ![img](img/login-erase-account.PNG)

        2. ä½¿ç”¨ä»¥ä¸Šå¾—åˆ°çš„ç”¨æˆ·é‚®ç®±è¿›è¡ŒSQLæ³¨å…¥æ”»å‡»ï¼Œè¾“å…¥`chris.pike@juice-sh.op'--`ç™»å…¥chrisçš„å¸å·

            ![img](img/login-erase.PNG)

    - Password Strength(â­â­)

        è§£ç tokenä¿¡æ¯ï¼Œæš´åŠ›ç ´è§£adminè´¦æˆ·å¯†ç ï¼ˆadmin123ï¼‰

        ![img](img/password-strength-token.PNG)

        ![img](img/password-strength.PNG)

    - Reset Jim's Password(â­â­â­)

        1. ä½¿ç”¨SQLæ³¨å…¥æ”»å‡»ç™»å…¥Jimçš„å¸å·ï¼ŒæŸ¥æ‰¾å¯èƒ½ä¸Jimçš„èº«ä»½ç›¸å…³çš„ä¿¡æ¯ï¼Œåœ¨My saved addressesä¸­æ‰¾åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š
           
            ![img](img/login-jim-info.PNG)

        2. åœ¨googleä¸­è¾“å…¥å…³é”®å­—æœç´¢ï¼Œç­›æŸ¥åˆ°ç¬¦åˆæ¡ä»¶çš„äººç‰©ä¿¡æ¯ï¼Œå¹¶æŸ¥çœ‹å…¶å®¶åº­å…³ç³»ï¼Œå‘ç°Samuelä¸ºå¯†ä¿é—®é¢˜çš„ç­”æ¡ˆ

            ![img](img/login-jim-search.PNG)

            <img src="img/login-jim-family.PNG" alt="img" style="zoom:50%;" />

        3. æ›´æ”¹å¯†ç å³å¯å®Œæˆå®éªŒ

            ![img](img/jim-password-reset.PNG)

- **Security Misconfiguration**

    - Deprecated Interface(â­â­)

        1. ä¸ºäº†å®Œæˆè¿™ä¸ªå®éªŒï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç½‘é¡µä¸æœ¬åœ°äº¤äº’çš„æ¥å£ï¼ŒæŸ¥çœ‹ç½‘é¡µåŠŸèƒ½åå‘ç°éšè—çš„ä¾§è¾¹æ ä¸­Complaintæ­£å¥½å¯ä»¥æ»¡è¶³è¿™ä¸ªéœ€æ±‚

        2. è™½ç„¶ä¸Šä¼ æ–‡ä»¶çš„ç•Œé¢ä¸­é»˜è®¤è¿‡æ»¤é™¤äº†.pdfä¸.zipä»¥å¤–çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½†é€‰æ‹©äº†`All Files`é€‰é¡¹åè¯¥è¿‡æ»¤åŠŸèƒ½å³å¯è¢«å±è”½ï¼Œä¹‹åéšä¾¿å†™ä¸€ä¸ª.xmlè„šæœ¬å³å¯å®Œæˆå®éªŒ

            ![img](img/deprecated-interface-xml.PNG)

        ![img](img/deprecated-interface.PNG)

    - Error Handling(â­)

        è‡³ä»Šæ²¡æƒ³æ˜ç™½è¿™ä¸ªå®éªŒæˆ‘æ˜¯æ€ä¹ˆå®Œæˆçš„ï¼Œä¼¼ä¹æ˜¯åœ¨æ¢ç´¢ç½‘é¡µåŠŸèƒ½çš„æ—¶å€™è«åå…¶å¦™å°±ç»“æŸäº†ï¼Ÿï¼Ÿï¼Ÿ

        ![img](img/error-handling.PNG)

- **Improper Input Validation**

    - Missing Encoding(â­)

        1. æ‰“å¼€FireFox - Inspect Elementå¯»æ‰¾çº¿ç´¢ï¼Œæ‰¾åˆ°ä¸€æ¡ç–‘ä¼¼åœ¨twitterä¸Šå‘æ–‡çš„é“¾æ¥åæ‰“å¼€å¦‚ä¸‹ï¼š

            ![img](img/missing-encoding-tweet.PNG)

            æŒ‰ç…§URLå†…å®¹ï¼Œtweetçš„å†…å®¹åº”è¯¥ä¸ºï¼šğŸ˜¼ #zatschi #whoneedsfourlegs @owasp_juiceshop #appsec ï¼Œä½†æ­¤æ—¶åé¢çš„å†…å®¹å´è¢«æˆªæ–­ï¼Œå› æ­¤æ¨æµ‹æ˜¯ç¼–ç çš„é”…ï¼Œä¸”é—®é¢˜å‡ºåœ¨`#`ä¸Š

        2. æ›´æ”¹twitterå‘æ–‡URLçš„ç¼–ç ï¼Œå°†`#`æ›´æ”¹ä¸º`%23`ï¼Œå‘ç°å†…å®¹å¯ä»¥æ­£å¸¸æ˜¾ç¤º

            ![img](img/missing-encoding-rev.PNG)

        3. è¿”å›åŸé¡µé¢ï¼Œæ›´æ”¹URLåå³å¯å®Œæˆå®éªŒ
        
            ï¼ˆæ­ªä¸ªæ¥¼ï¼ŒZayaçœŸå¯çˆ±ï¼

            ![img](img/missing-encoding.PNG)

    - Repetitive Registration(â­)

        1. éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œåœ¨Burp Suiteä¸­æ‰¾åˆ°ä¸æ³¨å†Œæœ‰å…³çš„è¯·æ±‚ï¼Œå¹¶å‘é€è‡³Repeater

            ![img](img/repetitive-registration-request.PNG)

        2. å°†passwordRepeatç½®ä¸ºç©ºåæ›´æ”¹æ³¨å†Œç”¨æˆ·åï¼Œå‘é€åå³å¯å®Œæˆå®éªŒ

            ![img](img/repetitive-registration-edit.PNG)

        ![img](img/repetitive-registration.PNG)

    - Zero Stars(â­)

        1. å…ˆç»™ä¸ªå¥½è¯„ï¼Œåœ¨Burp Suiteä¸­æ‰¾åˆ°ä¸æ³¨å†Œæœ‰å…³çš„è¯·æ±‚ï¼Œå¹¶å‘é€è‡³Repeater

            ![img](img/zero-stars-request.PNG)

        2. å°†ratingç½®ä¸º0åå‘é€å³å¯å®Œæˆå®éªŒ

            ![img](img/zero-stars-edit.PNG)

        ![img](img/zero-stars.PNG)

    - Admin Registration(â­â­â­)

        1. åœ¨Burp Suiteä¸­æ‰¾åˆ°ä¸æ³¨å†Œæœ‰å…³çš„è¯·æ±‚ï¼Œå¹¶å‘é€è‡³Repeater

            ![img](img/repetitive-registration-request.PNG)

        2. æ›´æ”¹ç”¨æˆ·åå¹¶åˆ é™¤å¯†ä¿é—®é¢˜ä¸ç­”æ¡ˆéƒ¨åˆ†ï¼Œå‘é€å³å¯å®Œæˆå®éªŒ

            ![img](img/admin-registration-edit.PNG)

        ![img](img/admin-registration.PNG)

    - Payback Time(â­â­â­)

        1. å½“è´­ç‰©è½¦ä¸­ç‰©å“æ•°é‡ä¸ºæ­£æ•°æ—¶ï¼Œç»“è´¦æ—¶è´¦æˆ·çš„ä½™é¢ä¼šå‡å°‘ï¼Œå› æ­¤å®Œæˆæ­¤é¡¹å®éªŒä¸€ä¸ªæœ€ç›´æ¥çš„æ€è·¯æ˜¯ï¼šè®©è´­ç‰©è½¦ä¸­çš„ç‰©å“æ•°é‡ä¸ºè´Ÿæ•°

        2. ç”±äºç½‘é¡µç•Œé¢ä¸æ”¯æŒå°†å•†å“æ•°é‡æ”¹ä¸ºè´Ÿæ•°ï¼Œå› æ­¤éœ€åœ¨Burp Suiteä¸­æ‰¾åˆ°ä¸å°†å•†å“åŠ å…¥è´­ç‰©è½¦æœ‰å…³çš„è¯·æ±‚ï¼Œå¹¶å‘é€è‡³Repeaterï¼Œä¹‹åå°†å•†å“æ•°é‡ä¿®æ”¹ä¸ºè´Ÿæ•°ï¼Œç»“è´¦åå³å¯å®Œæˆå®éªŒ

            ![img](img/payback-time-edit.PNG)

            æ“ä½œç»“æœå¦‚ä¸‹ï¼š

            ![img](img/payback-time-basket.PNG)

        ![img](img/payback-time.PNG)

    - Upload Size(â­â­â­)

        1. åœ¨FireFox - Inspect Element - Debuggerä¸­æ‰¾åˆ°ä¸ä¸Šä¼ æ–‡ä»¶æœ‰å…³çš„æºç main-es2018.jsï¼Œè¿›å…¥å®¹å™¨ä¸­å¯¹æ–‡ä»¶ä¸Šä¼ é•¿åº¦é™åˆ¶çš„éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼ˆåŸæœ¬ä¸º1e5ï¼‰ï¼Œå¹¶é‡å»ºå®¹å™¨

            ![img](img/upload-size-code.PNG)

        2. å›åˆ°Complainté¡µé¢è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œæ­¤æ—¶ä¸Šä¼ å¤§äº100KBçš„æ–‡ä»¶ä¸ä¼šæŠ¥é”™ï¼Œä¹Ÿå¯ä»¥æˆåŠŸæäº¤ï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰å®ŒæˆæŒ‘æˆ˜çš„æé†’ï¼Œä½†æŒ‰ç…§é¢˜è§£å°†æ–‡ä»¶æ ¼å¼æ”¹ä¸º.pdfä»¥åå°±å¯ä»¥æˆåŠŸä¸Šä¼ ï¼ˆå¸Œæœ›å¯ä»¥è¹²åˆ°ä¸€ä¸ªè§£ç­”qwq

            <img src="img/upload-size-commit.PNG" alt="img" style="zoom:50%;" />

            <img src="img/upload-size-info.PNG" alt="img" style="zoom:45%;" />

        ![img](img/upload-size.PNG)

    - Upload Type(â­â­â­)

        1. åŒä¸Šï¼Œè¿›å…¥å®¹å™¨å¯¹main-es2018.jsè¿›è¡Œä¿®æ”¹ï¼Œå¢åŠ è¦ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼Œå¹¶é‡å»ºå®¹å™¨

            ![img](img/upload-type-code.PNG)

        2. åœ¨Burp Suiteä¸­æ‰¾åˆ°ä¸ä¸Šä¼ æ–‡ä»¶ç›¸å…³çš„è¯·æ±‚å‘é€è‡³Repeaterï¼Œä¿®æ”¹ç›¸å…³å‚æ•°åå‘é€å³å¯å®Œæˆå®éªŒ

            ![img](img/upload-type-edit.PNG)

        ![img](img/upload-type.PNG)

- **Broken Access Control**

    - Admin Section(â­â­)

        ä¹‹å‰åšå®éªŒçš„æ—¶å€™åœ¨Burpä¸­çœ‹è§äº†è¯·æ±‚URLä¸­æœ‰administrationå­—æ ·ï¼Œå› æ­¤è·¯å¾„æ¯”è¾ƒå¥½çŒœï¼›ç™»å…¥adminè´¦æˆ·è¾“å…¥`127.0.0.1:3000/#/administration`å³å¯å®Œæˆè®¿é—®

        ![img](img/admin-section.PNG)

    - Five-Star Feedback(â­â­)

        ä½¿ç”¨adminè´¦æˆ·ç™»å…¥åè®¿é—®`127.0.0.1:3000/#/administration`ï¼Œåˆ é™¤5æ˜Ÿå¥½è¯„å³å¯

        ![img](img/five-star-feedback.PNG)

    - Forged Feedback(â­â­â­)

        1. éšä¾¿ç™»å…¥ä¸€ä¸ªå¸å·å‘å¸ƒåé¦ˆï¼Œåœ¨Burp Suiteä¸­æˆªå–è¯·æ±‚

        2. ç™»å…¥å¦ä¸€ä¸ªå¸å·ï¼Œå°†åˆšæ‰çš„è¯·æ±‚ä¿®æ”¹åé¦ˆä¿¡æ¯åé‡å‘ï¼ˆè¯¥æ“ä½œçš„ç›®çš„æ˜¯ä¸ºäº†ä¿ç•™tokenï¼‰

            ![img](img/forged-feedback-edit.PNG)

        ![img](img/forged-feedback.PNG)

    - Forged Review(â­â­â­)

        1. éšä¾¿æŒ‘é€‰ä¸€ä¸ªå•†å“å‘è¡¨å¥½è¯„ï¼Œå‘ç°åœ¨Burp Suiteä¸­æˆªå–ä¸åˆ°ç›¸å…³è¯·æ±‚ï¼Œäºæ˜¯æ‰“å¼€FireFox - Inspect Element - Networkï¼Œå‘ç°åœ¨PUTè¯·æ±‚ä¸­åŒ…å«äº†è¯„è®ºçš„ç›¸å…³ä¿¡æ¯

            ![img](img/forged-review-put.PNG)

        2. æ›´æ”¹è¯·æ±‚ä¸­çš„messageå’Œauthorå‚æ•°å¹¶å‘é€å³å¯

            <img src="img/forged-review-comment.PNG" alt="img" style="zoom:50%;" />

        ![img](img/forged-review.PNG)

    - Manipulate Basket(â­â­â­)

        1. å°†å•†å“åŠ å…¥è´­ç‰©è½¦ååœ¨Burp Suiteä¸­è§‚å¯Ÿè¯·æ±‚ç‰¹å¾ï¼Œæ‰¾åˆ°ä¸åŠ è´­å•†å“ç›¸å…³çš„è¯·æ±‚åå‘é€è‡³Repeater

        2. åœ¨Repeaterä¸­ç¼–è¾‘è¯·æ±‚å‚æ•°ï¼Œæœ€ç›´æ¥çš„æƒ³æ³•æ˜¯æ›´æ”¹BasketIdï¼Œä½†å•çº¯ä¿®æ”¹BasketIdåå‘é€ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š

            ![img](img/manipulate-basket-error.PNG)

            å› æ­¤é€‰æ‹©åœ¨åŸæ¥çš„BasketIdåå¢åŠ å…¶ä»–çš„BasketIdï¼Œå‘é€åå³å¯å®Œæˆå®éªŒ

            ![img](img/manipulate-basket-edit.PNG)

        ![img](img/manipulate-basket.PNG)

    - View Basket(â­â­)

        åœ¨FireFox - Inspect Element - Storage - Session Storageä¸­ä¿®æ”¹bidï¼ˆbasketIdï¼‰å³å¯æŸ¥çœ‹ä¸åŒç”¨æˆ·çš„è´­ç‰©è½¦ä¿¡æ¯

        ![img](img/basket-bid-1.PNG)

        ![img](img/basket-bid-2.PNG)

        ![img](img/basket-bid-3.PNG)

        ![img](img/basket-bid-4.PNG)

        ![img](img/basket-bid-5.PNG)

### 7. é‡åˆ°çš„é—®é¢˜

- è®¿é—®Juice Shopæ—¶æ˜¾ç¤º`403 Forbidden`

    **å‡ºé”™åŸå› ï¼š** ä»£ç†ç«¯å£å‘ç”Ÿå†²çª

    **è§£å†³æ–¹æ³•ï¼š** é‡æ–°è®¾ç½®ä»£ç†ç«¯å£ï¼Œå¹¶åœ¨Burp Suiteä¸­å¯¹ä¹‹è¿›è¡Œç›‘å¬

    ![img](img/p1-proxy.PNG)

    ![img](img/p1-burp.PNG)

- å®¹å™¨juice-shopä¸­æ— æ³•ä½¿ç”¨apt

    **è§£å†³æ–¹æ³•ï¼š** ä½¿ç”¨apkæ›¿ä»£å³å¯


### 8. å‚è€ƒèµ„æ–™

- [Juice Shop Official Documents](https://bkimminich.gitbooks.io/pwning-owasp-juice-shop/content/)

- [Juice Shop Official Solutions](https://bkimminich.gitbooks.io/pwning-owasp-juice-shop/content/appendix/solutions.html)

- [SQL injection UNION attacks](https://portswigger.net/web-security/sql-injection/union-attacks)

- [The Schema Table | SQLite](https://sqlite.org/schematab.html)

- [Frequently Asked Questions | SQLite](https://www.sqlite.org/faq.html)

- [XML External Entity (XXE) Processing](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing)

- [How to run vi on docker container?](https://stackoverflow.com/questions/31515863/how-to-run-vi-on-docker-container)